plugins {
    id 'java'
}

group = 'hello'
version = '0.0.1-SNAPSHOT'
sourceCompatibility = '8'

repositories {
    mavenCentral()
}

dependencies {
    //스프링 MVC 추가
    implementation group: 'org.springframework', name: 'spring-webmvc', version: '5.0.6.RELEASE'

    //내장 톰켓 추가
    implementation 'org.apache.tomcat.embed:tomcat-embed-core:8.5.69'
}

tasks.named('test') {
    useJUnitPlatform()
}

//일반 Jar 생성
task buildJar(type: Jar) { //./graldew clean buildJar 하면, build/libs 하위에 snapshot jar 파일 생성됨
    manifest {
        attributes 'Main-Class': 'hello.embed.EmbedTomcatSpringMain' // MENIFEST 파일 자동으로 생성됨
    }
    with jar
}

//Fat Jar 생성
task buildFatJar(type: Jar) {
    manifest {
        attributes 'Main-Class': 'hello.embed.EmbedTomcatSpringMain'
    }
    duplicatesStrategy = DuplicatesStrategy.WARN
    from { configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) } }
    with jar
}
